<!DOCTYPE html><html lang="zh-Hant">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>進口成本暨稅務解析｜台灣進口稅務會計儀表板</title>
<style>
  :root{
    --bg:#ffffff;--fg:#333333;--muted:#8a8a8a;--line:#e6e6e6;--accent:#007AFF;
  }
  html,body{background:var(--bg);color:var(--fg);font:16px/1.6 -apple-system, BlinkMacSystemFont, "Helvetica Neue", "Noto Sans TC", "PingFang TC", Arial, system-ui, sans-serif;}
  *{box-sizing:border-box}
  .wrap{max-width:980px;margin:0 auto;padding:16px}
  /* 顶端儀表板 */
  .topbar{position:sticky;top:0;background:var(--bg);border-bottom:1px solid var(--line);}
  .topbar-inner{display:flex;gap:16px;align-items:center;justify-content:space-between;max-width:980px;margin:0 auto;padding:12px 16px}
  .brand{font-weight:600;letter-spacing:.02em}
  .title{font-size:20px}
  .tabs{display:flex;gap:8px}
  .tab{appearance:none;background:transparent;border:0;border-bottom:2px solid transparent;padding:6px 10px;cursor:pointer;color:var(--fg)}
  .tab[aria-selected="true"]{border-bottom-color:var(--fg)}
  .tab:hover{color:var(--accent);border-bottom-color:var(--accent)} /* 強調色只在 hover */
  /* 內容區 */
  .section{display:none;padding:16px 0}
  .section[aria-hidden="false"]{display:block}
  h2{font-size:18px;margin:0 0 8px}
  h3{font-size:16px;margin:16px 0 8px}
  p{margin:8px 0}
  .grid{display:grid;grid-template-columns:1fr 1fr;gap:12px}
  @media (max-width:720px){.grid{grid-template-columns:1fr}}
  label{display:block;font-size:14px;color:var(--muted);margin-bottom:4px}
  input,select{width:100%;height:38px;border:1px solid #ccc;padding:6px 8px;border-radius:0;background:#fff;color:var(--fg)}
  input:focus,select:focus{outline:none;border-color:#999}
  input[disabled]{background:#f6f6f6;color:#9a9a9a}
  .btn{appearance:none;border:1px solid #ccc;background:#fff;padding:8px 12px;height:40px;cursor:pointer}
  .btn:hover{color:var(--accent);border-color:var(--accent)} /* 強調色只在 hover */
  .row{display:flex;gap:10px;flex-wrap:wrap;align-items:flex-end}
  .status{min-height:20px;color:#c40000;font-size:14px;margin-top:8px}
  .card{border-top:1px solid var(--line);padding-top:12px;margin-top:12px}
  .kvs{display:grid;grid-template-columns:1.6fr 1fr;gap:6px 12px;align-items:baseline}
  .kvs div.k{color:#666}
  .kvs div.v{text-align:right}
  .note{font-size:14px;color:#666;margin-top:6px}
  .hr{border-top:1px solid var(--line);margin:12px 0}
  .toggle{appearance:none;border:0;background:transparent;padding:0;color:var(--fg);text-decoration:underline;cursor:pointer}
  .toggle:hover{color:var(--accent)}
  .mono{font-variant-numeric: tabular-nums}
  /* 極簡排版（詳細頁） */
  .prose h3{margin-top:20px}
  .prose ul{margin:8px 0 8px 18px}
  .prose li{margin:4px 0}
  /* 全域錯誤 Toast */
  .toast{position:fixed;left:50%;transform:translateX(-50%);bottom:16px;border:1px solid #d33;padding:8px 12px;background:#fff;color:#d33;display:none}
</style>
</head>
<body>
  <header class="topbar" role="banner">
    <div class="topbar-inner">
      <div class="brand title">進口成本暨稅務解析 (Import Cost & Tax Analysis)</div>
      <nav class="tabs" role="tablist" aria-label="分頁切換">
        <button class="tab" role="tab" aria-selected="true" data-action="tab" data-target="#tab-calc">輸入數值頁面</button>
        <button class="tab" role="tab" aria-selected="false" data-action="tab" data-target="#tab-doc">詳細頁面說明解釋</button>
      </nav>
    </div>
  </header>  <main class="wrap" role="main">
    <!-- 分頁一：計算器 -->
    <section id="tab-calc" class="section" aria-hidden="false">
      <h2>分頁一：輸入數值頁面</h2>
      <div class="card">
        <h3>A. 參數輸入區</h3>
        <div class="grid">
          <div>
            <label for="incoterm">國際貿易條件 (Incoterms)</label>
            <select id=\"incoterm\">
              <option value=\"EXW\">EXW（Ex Works 出廠）</option>
              <option value=\"FAS\">FAS（Free Alongside Ship 船邊）</option>
              <option value=\"FOB\" selected>FOB（Free On Board 船上）</option>
              <option value=\"CFR\">CFR（Cost & Freight 含運費）</option>
              <option value=\"CIF\">CIF（Cost, Insurance & Freight 含運保）</option>
              <option value=\"C&I\">C&I（Cost & Insurance 含保險）</option>
              <option value=\"DPU\">DPU（Delivered at Place Unloaded 卸貨地交貨）</option>
            </select>
          </div>
          <div>
            <label for="fx">新台幣匯率</label>
            <input id="fx" type="number" inputmode="decimal" step="0.0001" placeholder="請輸入如 32.1500" />
          </div>
          <div>
            <label id="priceLabel" for="price">離岸價格 (FOB) ‧ 外幣金額</label>
            <input id="price" type="number" inputmode="decimal" step="0.01" placeholder="外幣金額" />
          </div>
          <div>
            <label for="freight">運費 (Freight) ‧ 外幣金額</label>
            <input id="freight" type="number" inputmode="decimal" step="0.01" placeholder="FOB 模式啟用" />
          </div>
          <div>
            <label for="ins">保險費 (Insurance) ‧ 外幣金額</label>
            <input id="ins" type="number" inputmode="decimal" step="0.01" placeholder="FOB 模式啟用" />
          </div>
          <div>
            <label for="dutyRate">關稅稅率 (%)</label>
            <input id="dutyRate" type="number" inputmode="decimal" step="0.0001" placeholder="如 10 表示 10%" />
          </div>
          <div>
            <label for="goodTaxRate">貨物稅率 (%)</label>
            <input id="goodTaxRate" type="number" inputmode="decimal" step="0.0001" placeholder="無則輸入 0" />
          </div>
        </div>
        <div class="row" style="margin-top:10px">
          <button class="btn" data-action="calc">計算成本結構</button>
        </div>
        <div class="status" id="status"></div>
      </div><div class="card" id="out" hidden>
    <h3>B. 計算結果輸出區（新台幣 NTD）</h3>
    <div class="kvs mono" id="kv"></div>
    <p class="note">註：營業稅（5%）屬進項稅額，可供未來銷項稅額扣抵，<strong>不計入存貨成本</strong>。</p>
  </div>

  <div class="card" id="steps" hidden>
    <h3>C. 計算邏輯解析（Step-by-Step Explanation）</h3>
    <p>
      <button class="toggle" data-action="toggle-steps" aria-expanded="false" aria-controls="steps-body">展開步驟</button>
    </p>
    <div id="steps-body" hidden></div>
  </div>
</section>

<!-- 分頁二：說明文件 -->
<section id=\"tab-doc\" class=\"section prose\" aria-hidden=\"true\">
  <h2>分頁二：詳細頁面說明解釋</h2>
  <h3>交貨條件對進口成本認列的影響</h3>
  <ul>
    <li><strong>EXW（出廠交貨）</strong>：賣方僅交貨於廠區；買方負擔內陸運、出口報關、海運、保險等。進口商成本＝貨價＋買方實付之運保與報關等必要費用。</li>
    <li><strong>FAS（船邊交貨）</strong>：賣方交貨至出口港船邊；其後費用與風險轉由買方。進口商成本含發票價款＋後續海運、保險、卸貨、拖櫃等買方自付費用。</li>
    <li><strong>FOB（船上交貨）</strong>：賣方裝船後責任了結；買方負擔海運與保險。買方若實際支付運/保，可併入進貨成本。</li>
    <li><strong>CFR（含運費）</strong>：價格含海運、不含保險。進口商將發票價入帳，另把買方自付保險與目的港後續費用列入成本；運費不再另列。</li>
    <li><strong>CIF（含運費保險）</strong>：價格含運保；進口商成本以發票價為準，不再另外計列運/保。若取得運費單據，僅供出口商列帳，進口商不得再列成本。</li>
    <li><strong>C&amp;I（含保險）</strong>：等同 FOB + 保險；價格含保險，不含運費。進口商另計買方支付之海運費入成本。</li>
    <li><strong>DPU（卸貨地交貨）</strong>：賣方負責運至約定地並卸貨；契約價通常含運保與卸貨。入帳以發票總價為貨物成本；完稅時目的港卸貨後費用不入 DPV。</li>
  </ul>

  <h3>發票金額、報關金額與進項稅憑證</h3>
  <p>商業發票為契約價；關稅完稅價格（DPV）依報關條件與實際費用調整。FOB 需加買方運保；CIF 可採發票價作 DPV。若使用 FCA、DAT/DPU 等，報關應選擇相近條件並於「應加費用」補列差額。進口營業稅以海關代徵，須以「海關進口貨物稅費繳納證明」作為進項憑證；報關義務人須為公司，方得扣抵。</p>

  <h3>完稅價格與各稅計算（提要）</h3>
  <ul>
    <li>DPV = FOB + 國外運費 + 國外保險費（CIF 約當已含運保；EXW 需加買方承擔之運險）。</li>
    <li>關稅 = DPV × 關稅稅率。</li>
    <li>貨物稅 = (DPV + 關稅) × 貨物稅率；菸酒稅多為定額。</li>
    <li>推廣貿易服務費 = DPV × 0.04%（不足 NT$100 免徵）。</li>
    <li>營業稅基 = DPV + 關稅 + 貨物稅 + 推廣貿易服務費；營業稅 = 稅基 × 5%。</li>
  </ul>

  <h3>會計入帳時點與金額判斷</h3>
  <p>存貨以實際成本計量，包含貨價與一切必要費用（運、保、報關、關稅等）。通常到港通關或驗收入庫時入帳；匯差另列兌換損益。入帳須備齊發票、海關完稅單據、運保費憑證與結匯文件。</p>

  <h3>實務常見錯誤與建議</h3>
  <ul>
    <li>勿將 CIF 的運保重複列入成本；FOB/EXW 下，記得把買方自付運保併入成本。</li>
    <li>報關價值不得低報或遺漏附加費；完整申報可獲正確進項稅扣抵。</li>
    <li>報關義務人須為公司統編；憑證不全無法扣抵。</li>
    <li>正確匯率換算並分攤運保關稅至庫存單位成本，避免成本失真。</li>
  </ul>

  <h3>入帳摘要</h3>
  <p>總存貨成本 = DPV（新台幣） + 關稅 + 貨物稅 + 推廣貿易服務費。海關應付總額 = 關稅 + 貨物稅 + 推廣貿易服務費 + 營業稅（5%）。營業稅屬進項稅額，可供抵扣，不入成本。</p>
</section>

  </main>  <div id="toast" class="toast" role="alert"></div><script defer>
(function(){
  const $ = (q,root=document)=>root.querySelector(q);
  const $$ = (q,root=document)=>[...root.querySelectorAll(q)];
  const state = {incoterm:'FOB'};

  function setTab(targetSel){
    const target = $(targetSel);
    $$('.section').forEach(s=>s.setAttribute('aria-hidden','true'));
    target.setAttribute('aria-hidden','false');
    $$('.tab').forEach(b=>b.setAttribute('aria-selected', String('#'+$(b).dataset?.target?.slice?.(1)===targetSel)));
  }

  function updateIncotermUI(){
    const inc = $('#incoterm').value;
    state.incoterm = inc;
    const freight = $('#freight');
    const ins = $('#ins');
    const priceLabel = $('#priceLabel');

    // 映射：各交貨條件何者已含於價格
    const includes = {
      EXW:{F:false,I:false,label:'出廠價 (EXW) ‧ 外幣金額'},
      FAS:{F:false,I:false,label:'船邊價 (FAS) ‧ 外幣金額'},
      FOB:{F:false,I:false,label:'離岸價格 (FOB) ‧ 外幣金額'},
      CFR:{F:true, I:false,label:'含運費價格 (CFR) ‧ 外幣金額'},
      CIF:{F:true, I:true ,label:'到岸價格 (CIF) ‧ 外幣金額'},
      'C&I':{F:false,I:true,label:'含保險價格 (C&I) ‧ 外幣金額'},
      DPU:{F:true, I:true ,label:'卸貨地交貨價 (DPU) ‧ 外幣金額'}
    }[inc];

    // 欄位啟用規則：未含者→啟用輸入；已含者→反灰鎖定
    if(includes.F){ freight.disabled = true; freight.value = ''; } else { freight.disabled = false; }
    if(includes.I){ ins.disabled = true; ins.value = ''; } else { ins.disabled = false; }
    priceLabel.textContent = includes.label;
  }
  }

  function fmt(n){
    return new Intl.NumberFormat('zh-Hant-TW',{style:'currency',currency:'TWD',minimumFractionDigits:2,maximumFractionDigits:2}).format(n);
  }
  function fnum(n){
    return new Intl.NumberFormat('zh-Hant-TW',{minimumFractionDigits:2,maximumFractionDigits:2}).format(n);
  }

  function valNum(id, required=true){
    const v = parseFloat($(id).value);
    if(Number.isFinite(v)) return v;
    if(required) throw new Error('請正確輸入「'+$(id).previousElementSibling.textContent.replace(/\s+/g,' ').trim()+'」。');
    return 0;
  }

  function calc(){
    const status = $('#status');
    status.textContent = '';
    try{
      const inc = $('#incoterm').value;
      const fx = valNum('#fx');
      const price = valNum('#price');
      let freight = 0, ins = 0;
      // 依條件決定哪些成本需自填併入 DPV
      if(inc==='EXW' || inc==='FAS' || inc==='FOB'){
        freight = valNum('#freight');
        ins = valNum('#ins');
      }else if(inc==='CFR'){
        // 價格含運費，不含保險
        ins = valNum('#ins');
      }else if(inc==='C&I'){
        // 價格含保險，不含運費
        freight = valNum('#freight');
      }else if(inc==='CIF' || inc==='DPU'){
        // 價格已含運保（DPU 另含目的地卸貨，但卸貨後費用不入 DPV）
      }

      // 1) DPV 外幣
      const dpvFx = price + freight + ins; // 價格內含部分自動為 0
      // 2) DPV 新台幣
      const dpv = dpvFx * fx;
      // 3) 稅費（新台幣）
      const dutyRate = valNum('#dutyRate');
      const goodTaxRate = valNum('#goodTaxRate', false) || 0;
      const duty = dpv * (dutyRate/100);
      const goodsTax = (dpv + duty) * (goodTaxRate/100);
      let promoFee = dpv * 0.0004; // 0.04%
      if(promoFee < 100) promoFee = 0; // 不足 100 元免徵
      const vatBase = dpv + duty + goodsTax + promoFee;
      const vat = vatBase * 0.05;
      // 4) 成本與應付
      const totalInvCost = dpv + duty + goodsTax + promoFee; // 不含 VAT
      const totalToCustoms = duty + goodsTax + promoFee + vat;

      // 輸出
      const kv = $('#kv');
      kv.innerHTML = ''
        + row('完稅價格 (DPV)', fmt(dpv))
        + row('進口關稅', fmt(duty))
        + row('貨物稅', fmt(goodsTax))
        + row('推廣貿易服務費', fmt(promoFee))
        + row('營業稅稅基', fmt(vatBase))
        + row('營業稅 (VAT 5%)', fmt(vat))
        + '<div class="hr"></div>'
        + row('總存貨成本 (Total Inventory Cost)', '<strong>'+fmt(totalInvCost)+'</strong>')
        + row('海關應付總額 (Total Payable to Customs)', '<strong>'+fmt(totalToCustoms)+'</strong>');
      $('#out').hidden = false;

      // 步驟
      const s = [];
      s.push('<h4>確認完稅價格 (DPV)</h4>');
      const incDesc = {
        EXW:'EXW：出廠價不含運保，DPV（外幣）＝出廠價＋海運費＋保險費',
        FAS:'FAS：船邊價不含運保，DPV（外幣）＝船邊價＋海運費＋保險費',
        FOB:'FOB：離岸價不含運保，DPV（外幣）＝FOB＋海運費＋保險費',
        CFR:'CFR：價格含運費不含保險，DPV（外幣）＝CFR＋保險費',
        CIF:'CIF：價格含運保，DPV（外幣）＝CIF',
        'C&I':'C&I：價格含保險不含運費，DPV（外幣）＝C&I＋海運費',
        DPU:'DPU：價格通常已含運保暨卸貨；DPV以到岸（CIF 等效）估算，卸貨後費用不入 DPV'
      }[inc];
      s.push('<p>'+incDesc+'。帶入：<strong>'+fnum(price)+'</strong>（主價）'+(freight? ' ＋ '+fnum(freight)+'（運）':'' )+(ins? ' ＋ '+fnum(ins)+'（保）':'' )+' ＝ <strong>'+fnum(dpvFx)+'</strong>（外幣）。</p>');
      s.push('<p>DPV（新台幣）＝DPV（外幣）×新台幣匯率＝'+fnum(dpvFx)+' × '+fnum(fx)+' ＝ <strong>'+fmt(dpv)+'</strong>。</p>');

      s.push('<h4>計算各項稅費（新台幣）</h4>');
      s.push('<p>推廣貿易服務費＝DPV × 0.04%＝'+fmt(dpv)+' × 0.0004 ＝ '+fmt(dpv*0.0004)+'；不足新臺幣 100 元則免徵，故本案為 <strong>'+fmt(promoFee)+'</strong>。</p>');
      s.push('<p>進口關稅＝DPV × 關稅稅率＝'+fmt(dpv)+' × '+fnum(dutyRate)+'% ＝ <strong>'+fmt(duty)+'</strong>。</p>');
      s.push('<p>貨物稅＝(DPV＋關稅) × 貨物稅率＝('+fmt(dpv)+'＋'+fmt(duty)+') × '+fnum(goodTaxRate)+'% ＝ <strong>'+fmt(goodsTax)+'</strong>。</p>');
      s.push('<p>營業稅稅基＝DPV＋關稅＋貨物稅＋推廣貿易服務費＝'+fmt(dpv)+'＋'+fmt(duty)+'＋'+fmt(goodsTax)+'＋'+fmt(promoFee)+' ＝ <strong>'+fmt(vatBase)+'</strong>。</p>');
      s.push('<p>營業稅（進項）＝營業稅稅基 × 5% ＝ '+fmt(vatBase)+' × 5% ＝ <strong>'+fmt(vat)+'</strong>。</p>');

      s.push('<h4>釐清最終成本與支付款</h4>');
      s.push('<p>總存貨成本＝DPV＋關稅＋貨物稅＋推廣貿易服務費＝'+fmt(dpv)+'＋'+fmt(duty)+'＋'+fmt(goodsTax)+'＋'+fmt(promoFee)+' ＝ <strong>'+fmt(totalInvCost)+'</strong>（營業稅為進項稅額，不列入成本）。</p>');
      s.push('<p>海關應付總額＝關稅＋貨物稅＋推廣貿易服務費＋營業稅＝'+fmt(duty)+'＋'+fmt(goodsTax)+'＋'+fmt(promoFee)+'＋'+fmt(vat)+' ＝ <strong>'+fmt(totalToCustoms)+'</strong>。</p>');

      const stepsBody = $('#steps-body');
      stepsBody.innerHTML = s.join('
');
      $('#steps').hidden = false;
    }catch(err){
      status.textContent = err.message || String(err);
      $('#out').hidden = true; $('#steps').hidden = true;
    }
  }

  function row(k,v){
    return '<div class="k">'+k+'</div><div class="v">'+v+'</div>';
  }

  // 事件委派
  document.addEventListener('click', (ev)=>{
    const el = ev.target.closest('[data-action]');
    if(!el) return;
    const act = el.dataset.action;
    if(act==='tab'){
      const target = el.dataset.target; setTab(target);
      $$('.tab').forEach(b=>b.setAttribute('aria-selected', String(b===el)));
    }
    if(act==='calc') calc();
    if(act==='toggle-steps'){
      const body = $('#steps-body');
      const open = body.hasAttribute('hidden')?false:true;
      if(open){ body.setAttribute('hidden',''); el.setAttribute('aria-expanded','false'); el.textContent='展開步驟'; }
      else{ body.removeAttribute('hidden'); el.setAttribute('aria-expanded','true'); el.textContent='收合步驟'; }
    }
  });

  // 下拉互動
  $('#incoterm').addEventListener('change', updateIncotermUI);
  updateIncotermUI();

  // 全域錯誤提示（極簡）
  const toast = $('#toast');
  function showToast(msg){ toast.textContent = msg; toast.style.display='block'; setTimeout(()=>toast.style.display='none', 4000); }
  window.addEventListener('error', e=>{ showToast('執行時錯誤：'+(e.message||'未知錯誤')); });
  window.addEventListener('unhandledrejection', e=>{ showToast('執行時錯誤：'+(e.reason&&e.reason.message)||'未知錯誤'); });
})();
</script></body>
</html>