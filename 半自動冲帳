# ã€æ™ºèƒ½å°å¸³æ²–éŠ·å·¥å…·ã€‘æŠ€è¡“éœ€æ±‚èªªæ˜æ›¸ (v2.0 å„ªåŒ–ç‰ˆ)

## 1. åŠŸèƒ½ç›®æ¨™
**æ ¸å¿ƒåƒ¹å€¼ï¼š** é€éæ¼”ç®—æ³•è‡ªå‹•æ¸…æ´—å¸³å‹™ï¼Œå°‡ã€Œå®Œå…¨åŒ¹é…ã€é …ç›®è‡ªå‹•å‰”é™¤ï¼Œå°‡ã€Œç–‘ä¼¼åŒ¹é…ã€é …ç›®äº¤ç”±äººå·¥ç¢ºèªï¼Œæœ€çµ‚å°‡ã€ŒæœªåŒ¹é…å·®ç•°ã€è½‰åŒ–ç‚º**å¯ç›´æ¥ä½¿ç”¨çš„æ–‡æœ¬æ ¼å¼**ï¼Œå¤§å¹…ç¸®çŸ­æœˆåº•çµå¸³èˆ‡å·®ç•°å ±å‘Šçš„è£½ä½œæ™‚é–“ã€‚

## 2. UI/UX è¨­è¨ˆè¦ç¯„ (å‘¼å¸æ„Ÿèˆ‡å±¤æ¬¡)

### å…¨åŸŸä½ˆå±€ (Layout)
æ¡ç”¨ **ä¸‰éšæ®µæ¼æ–—å¼ (Funnel View)** è¨­è¨ˆï¼Œå¼·èª¿æ•¸æ“šå¾ã€Œé›œäº‚ã€åˆ°ã€Œæ¸…æ™°ã€çš„éæ¿¾éç¨‹ã€‚

* **è‰²èª¿èªæ„ï¼š**
    * ğŸŸ¢ **ç¶ è‰² (å·²æ²–éŠ·)ï¼š** æ²‰ç©©ã€ä½å°æ¯”åº¦ï¼ˆè®“è¦–ç·šå¿½ç•¥å·²å®Œæˆé …ç›®ï¼‰ã€‚
    * ğŸŸ  **æ©˜è‰² (å¾…ç¢ºèª)ï¼š** é®®æ˜ã€å¼•å°æ“ä½œï¼ˆé€™æ˜¯ä½¿ç”¨è€…ä¸»è¦å·¥ä½œå€ï¼‰ã€‚
    * ğŸ”´ **ç´…è‰²/ç°è‰² (æœªåŒ¹é…)ï¼š** è­¦ç¤ºã€å¼·èª¿ï¼ˆæœ€çµ‚éœ€è¼¸å‡ºçš„çµæœï¼‰ã€‚
* **é–“è·ç­–ç•¥ï¼š** å€å¡Šé–“è· (Section Gap) è¨­å®šç‚º `48px`ï¼Œå…§å®¹é–“è· `16px`ï¼Œç¢ºä¿è¦–è¦ºå‹•ç·šä¸æ“æ“ ã€‚

## 3. è¼¸å…¥è¦æ ¼ (Input)

### 3.1 æ™ºèƒ½è²¼ä¸Šå€
* **äº¤äº’ï¼š** ä¸€å€‹å¤§çš„ Textareaï¼Œæ”¯æ´ Excel/CSV ç›´æ¥ `Ctrl+V`ã€‚
* **è³‡æ–™æ¸…æ´—é‚è¼¯ï¼š**
    * è‡ªå‹•ç§»é™¤ `"` (é›™å¼•è™Ÿ)ã€`$`ã€`Â¥`ã€`,` (åƒåˆ†ä½) ç­‰éæ•¸å€¼å­—å…ƒã€‚
    * è‡ªå‹•è­˜åˆ¥è² è™Ÿ `-` æˆ–æ‹¬è™Ÿ `(100)` ç‚ºè² å€¼ï¼ˆè‹¥é©ç”¨ï¼‰ã€‚
* **æ¬„ä½æ˜ å°„ (Mapping Modal)ï¼š**
    * è‹¥ç³»çµ±ç„¡æ³•è‡ªå‹•è­˜åˆ¥è¡¨é ­ï¼Œå½ˆå‡ºå°è©±æ¡†è©¢å•ï¼š
        * ã€Œè«‹å•å“ªä¸€æ¬„æ˜¯ **æ‘˜è¦**ï¼Ÿã€
        * ã€Œè«‹å•å“ªä¸€æ¬„æ˜¯ **å€Ÿæ–¹é‡‘é¡**ï¼Ÿã€
        * ã€Œè«‹å•å“ªä¸€æ¬„æ˜¯ **è²¸æ–¹é‡‘é¡**ï¼Ÿã€

## 4. æ ¸å¿ƒè™•ç†é‚è¼¯ (The Filter Engine)

ç³»çµ±å°‡è³‡æ–™è®€å…¥å¾Œï¼Œå»ºç«‹ä¸€å€‹ç‰©ä»¶é™£åˆ— `TransactionPool`ï¼Œä¸¦åŸ·è¡Œä»¥ä¸‹ä¸‰æ­¥éæ¿¾ï¼š

### æ­¥é©Ÿ 1ï¼šçµ•å°åŒ¹é… (Auto-Match)
* **é‚è¼¯ï¼š**
    1.  `Debit == Credit` (é‡‘é¡å®Œå…¨ä¸€è‡´)ã€‚
    2.  `Summary_A` èˆ‡ `Summary_B` çš„ç›¸ä¼¼åº¦ > 90% (å¹¾ä¹ä¸€æ¨£)ã€‚
* **å‹•ä½œï¼š** ç›´æ¥æ¨™è¨˜ç‚º `Status: Matched`ï¼Œç§»å…¥ã€Œå·²æ²–éŠ·æ¸…å–®ã€ã€‚

### æ­¥é©Ÿ 2ï¼šé‡‘é¡åˆ†çµ„èˆ‡äººå·¥ç¢ºèª (Pending Review)
* **é‚è¼¯ï¼š** å‰©é¤˜è³‡æ–™ä¸­ï¼Œå°‹æ‰¾ `Debit == Credit` ä½† `Summary` å·®ç•°å¤§çš„çµ„åˆã€‚
* **UI å‘ˆç¾ (å¾…ç¢ºèªå€)ï¼š**
    * ä»¥ã€Œé‡‘é¡ã€ç‚ºæ¨™é¡Œé€²è¡Œåˆ†çµ„å¡ç‰‡ (Card)ã€‚
    * **ä¾‹å­ï¼š**
        > **é‡‘é¡ï¼š$5,200**
        > [ ] å·¦å´ï¼šå» å•†è²¨æ¬¾ A (å€Ÿ)  <-->  [ ] å³å´ï¼šæ”¯ä»˜ 5200 (è²¸)
    * **æ“ä½œï¼š**
        * æä¾› **ã€Œä¸€éµå…¨éƒ¨èªåˆ—ã€** æŒ‰éˆ• (é©ç”¨æ–¼é‡‘é¡ç¨ç‰¹ï¼Œä¸å¤ªå¯èƒ½é…éŒ¯çš„æƒ…æ³)ã€‚
        * æä¾›å–®çµ„ **ã€Œå‹¾é¸åŒ¹é…ã€** åŠŸèƒ½ã€‚
* **å‹•ä½œï¼š** ç”¨æˆ¶ç¢ºèªå¾Œï¼Œç‹€æ…‹æ”¹ç‚º `Matched`ã€‚

### æ­¥é©Ÿ 3ï¼šæ®˜é¤˜æ­¸é¡ (Unmatched)
* **é‚è¼¯ï¼š** æ‰€æœ‰æœªè¢«ä¸Šè¿°å…©æ­¥è™•ç†çš„é …ç›®ï¼Œæ¨™è¨˜ç‚º `Status: Unmatched`ã€‚

## 5. è¼¸å‡ºè¦æ ¼ (Output & Report)

æ­¤å€åŸŸç‚ºæœ¬æ¬¡å„ªåŒ–çš„æ ¸å¿ƒï¼Œåˆ†ç‚ºã€Œè¦–è¦ºæ¸…å–®ã€èˆ‡ã€Œå ±å‘Šå­—ä¸²ã€ã€‚

### 5.1 æœªåŒ¹é…è¦–è¦ºæ¸…å–® (Visual List)
* é¡¯ç¤ºå‰©é¤˜çš„å€Ÿæ–¹èˆ‡è²¸æ–¹æ˜ç´°è¡¨æ ¼ã€‚

### 5.2 æ™ºèƒ½æ‘˜è¦ç”Ÿæˆå™¨ (Report Generator)
* **éœ€æ±‚æè¿°ï¼š** å°‡æœªåŒ¹é…é …ç›®çš„æ‘˜è¦èˆ‡é‡‘é¡ï¼Œæ‹¼æ¥æˆç‰¹å®šæ ¼å¼å­—ä¸²ï¼Œæ–¹ä¾¿è¤‡è£½ã€‚
* **æ ¼å¼é‚è¼¯ï¼š**
    * æ ¼å¼ï¼š`æ‘˜è¦(é‡‘é¡)`
    * åˆ†éš”ç¬¦ï¼š`ã€`
* **ç”Ÿæˆè¦å‰‡ï¼š**
    * è‹¥æœ‰å¤šç­†ï¼Œè‡ªå‹•ä¸²æ¥ã€‚
    * *å„ªåŒ–ï¼š* è‡ªå‹•æ¨™ç¤ºæ–¹å‘ï¼ˆå€Ÿ/è²¸ï¼‰ä»¥é˜²æ··æ·†ï¼ˆå¯é¸é–‹é—œï¼‰ã€‚
* **ç¯„ä¾‹è¼¸å‡ºæ¡† (Copy Area)ï¼š**
    * **æ¨™é¡Œï¼š** ã€ŒæœªåŒ¹é…é …ç›®æ‘˜è¦ (å¯ç›´æ¥è¤‡è£½)ã€
    * **å…§å®¹é è¦½ï¼š**
        ```text
        PC Homeé€€æ¬¾(1,200)ã€éŠ€è¡Œæ‰‹çºŒè²»(15)ã€æº¢ä»˜æ¬¾(500)
        ```
    * **æ“ä½œï¼š** åªæœ‰ä¸€å€‹å·¨å¤§çš„ **[ è¤‡è£½æ–‡å­— ]** æŒ‰éˆ•ã€‚

## 6. è³‡æ–™äº¤äº’èˆ‡è™•ç†æµç¨‹

### 6.1 è™•ç†èˆ‡é‚Šç•Œæƒ…æ³
| æƒ…æ³ | ç¨‹å¼é‚è¼¯ |
| :--- | :--- |
| **ä¸€å°å¤šé‡‘é¡ (1 vs 2)** | ä¾‹å¦‚ï¼šå€Ÿ 1000 vs è²¸ 500, è²¸ 500ã€‚ç›®å‰ç‰ˆæœ¬ä¸è‡ªå‹•åˆä½µã€‚é€™äº›æœƒè½å…¥ã€ŒæœªåŒ¹é…ã€å€ã€‚**å»ºè­°ï¼š** åœ¨æœªåŒ¹é…å€æä¾›ã€Œæ‰‹å‹•å¤šé¸å°æ²–ã€åŠŸèƒ½ (Advanced Feature)ã€‚ |
| **æ‘˜è¦åŒ…å«å¹²æ“¾å­—** | å¦‚ "è½‰å¸³ 10/20" vs "è½‰å¸³ 10/21"ã€‚å‰è™•ç†æ™‚å¯æ­£å‰‡ç§»é™¤æ—¥æœŸæ ¼å¼ `\d{2}/\d{2}` å†æ¯”å°ç›¸ä¼¼åº¦ã€‚ |
| **ç›¸åŒé‡‘é¡å¤šç­†** | å¦‚æœ‰ 5 ç­†éƒ½æ˜¯ $100ã€‚å…¨éƒ¨æ”¾å…¥ã€Œå¾…ç¢ºèªå€ã€ï¼Œç”±ç”¨æˆ¶å‹¾é¸å“ªç­†å°å“ªç­†ï¼Œæˆ–è€…æä¾›ã€ŒæŒ‰é †åºè‡ªå‹•æŠµéŠ·ã€é¸é …ã€‚ |

## 7. æœ€çµ‚äº¤ä»˜ä»£ç¢¼çµæ§‹åƒè€ƒ (Pseudo-code)

```javascript
// è¼¸å‡ºå­—ä¸²ç”Ÿæˆé‚è¼¯
function generateUnmatchedString(unmatchedList) {
  // 1. æå–æ‘˜è¦èˆ‡é‡‘é¡
  const distinctItems = unmatchedList.map(item => {
    // å–å¾—é‡‘é¡ (å„ªå…ˆå–å€Ÿæ–¹ï¼Œè‹¥ç„¡å‰‡å–è²¸æ–¹)
    const amount = item.debit > 0 ? item.debit : item.credit;
    // ç°¡å–®æ ¼å¼åŒ–
    return `${item.summary}(${amount})`;
  });

  // 2. æ‹¼æ¥
  return distinctItems.join("ã€");
}

// ç¯„ä¾‹åŸ·è¡Œçµæœ
// Input: [{summary: "å·®æ—…è²»", debit: 300}, {summary: "é›œæ”¯", credit: 50}]
// Output: "å·®æ—…è²»(300)ã€é›œæ”¯(50)"
